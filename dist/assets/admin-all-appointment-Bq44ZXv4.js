import{r as s,j as e,R as A,t as q}from"./index-Chad9CLA.js";import{d as J}from"./table-headers-NmVF5Ah3.js";import{D as K,E as Q,A as X,I as Z,a as ee}from"./appointment-report-B4EI5g7X.js";import{O as te}from"./admin-order-summary-pagination-D35sU1a_.js";import{A as ae}from"./appointment-modal-B8vJgyBP.js";import{L as se}from"./loading-table-BAb0c7Cl.js";import{D as ne}from"./date-range-picker-filter-J1tn3TTb.js";import{u as ie,S as oe}from"./search-bar-CgsKbdwB.js";import{d}from"./timezone-DS7qtbwd.js";import{a as re}from"./index-DW_MHI2K.js";import{c as de,b as le}from"./index-C06dF8FL.js";import{D as c}from"./Color-DmAsVZgK.js";import{g as pe}from"./generateGatePass-QcUr6W2f.js";import{a as ce}from"./menu-CM46qhEe.js";import{C as me}from"./calendar-plus-Cm3gfdkT.js";import"./createLucideIcon-C2ToIokP.js";import"./loading-spinner-BUHlXXSt.js";import"./triangle-alert-coWZifT7.js";import"./dialog-COJMBmk8.js";/* empty css                         */import"./checkAppointment-jH_aoGtD.js";import"./clsx-B-dksMZM.js";import"./pencil-BWuxfz4F.js";import"./chevron-down-Bns3dQA9.js";import"./floating-ui.react-dom-DaaYR0vm.js";import"./tslib.es6-Cz-Yey_7.js";import"./JsBarcode-I2dIIH-k.js";window.Buffer=le.Buffer;const ue=A.memo(oe),xe=A.memo(ne),he="https://prics-epod-backend.onrender.com";function He(){const[i,S]=s.useState([]),[m,v]=s.useState(1),[u,x]=s.useState(!1),[h,f]=s.useState(!1),[j,D]=s.useState(!1),[C,P]=s.useState(null),[E,I]=s.useState(null),[l,O]=s.useState(""),[N,T]=s.useState(""),[o,z]=s.useState(null),[r,k]=s.useState(null),[L]=s.useState("all"),[Y,g]=s.useState(!1);s.useEffect(()=>{(async()=>{g(!0);try{const n=(await re.get(`${he}/api/appointment`)).data.appointments;S(n)}catch(a){console.error("Failed to fetch appointment",a),q.error("We could not retrieve your appointment data. Please try again later.",{style:{backgroundColor:"#ff4d4d",color:"#fff"}})}finally{setTimeout(()=>{g(!1)},500)}})()},[]),ie(()=>T(l),500,[l]);const _=s.useMemo(()=>i.filter(t=>Object.values(t).some(a=>String(a).toLowerCase().includes(N.toLowerCase()))).filter(t=>{if(!o||!r)return!0;const a=new Date(t.appointment_date),n=new Date(r);return n.setHours(23,59,59,999),a>=o&&a<=n}),[i,N,o,r]),b=s.useMemo(()=>[..._].sort((t,a)=>{const n={pending:1,"in progress":2,completed:3},M=n[t.status.toLowerCase()]||4,y=n[a.status.toLowerCase()]||4;if(M!==y)return M-y;const V=new Date(t.appointment_date).setHours(new Date(t.appointment_time).getHours(),new Date(t.appointment_time).getMinutes(),new Date(t.appointment_time).getSeconds()),W=new Date(a.appointment_date).setHours(new Date(a.appointment_time).getHours(),new Date(a.appointment_time).getMinutes(),new Date(a.appointment_time).getSeconds());return V-W}),[_]),p=10,R=Math.ceil(b.length/p),w=(m-1)*p,$=w+p,B=b.slice(w,$),F=()=>{x(!0)},H=t=>{P(t),f(!0)},U=t=>{const a=i.find(n=>n.appointment_id===t);I(a),D(!0)},G=t=>{const a=t.charAt(0).toUpperCase()+t.slice(1).toLowerCase();return a==="Pending"?`${c.transit} text-white px-5 py-1 rounded-full capitalize`:a==="In progress"?`${c.receiving} text-white px-5 py-1 rounded-full capitalize`:a==="Completed"?`${c.delivered} text-white px-5 py-1 rounded-full capitalize`:"bg-gray-400 text-white px-5 py-1 rounded-full capitalize"};return e.jsxs(e.Fragment,{children:[u&&e.jsx(ae,{open:u,setOpen:x}),h&&e.jsx(K,{open:h,setOpen:f,selectedAppointmentId:C}),j&&e.jsx(Q,{open:j,setOpen:D,selectedAppointment:E}),Y?e.jsx(se,{}):i.length>0?e.jsx("div",{className:"table_section mt-5 font-inter w-full",children:e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"-m-1.5 overflow-x-auto",children:e.jsx("div",{className:"p-1.5 min-w-full inline-block align-middle",children:e.jsxs("div",{className:"border rounded-lg divide-y divide-gray-200",children:[e.jsx("div",{className:"py-5 px-4 flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center justify-between gap-x-2 w-full",children:[e.jsxs("div",{className:"flex items-center justify-center gap-x-2",children:[e.jsx(ue,{searchTerm:l,setSearchTerm:O}),e.jsx(X,{allData:i,type:L,startDate:o,endDate:r})]}),e.jsx("div",{children:e.jsx(xe,{startDate:o,endDate:r,setStartDate:z,setEndDate:k})})]})}),e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"th-user-table",children:e.jsx("tr",{children:J.map((t,a)=>e.jsx("th",{className:"px-6 py-3",children:t},a))})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:B.map((t,a)=>e.jsxs("tr",{className:a%2===0?"bg-[#F3F4F6]":"",children:[e.jsx("td",{className:"td-admin-table",children:t.appointment_id}),e.jsx("td",{className:"td-admin-table",children:t.carrier_name}),e.jsx("td",{className:"td-admin-table uppercase",children:t.plate_no}),e.jsx("td",{className:"td-admin-table",children:d(t.appointment_date).tz("Asia/Manila").format("MMMM DD, YYYY")}),e.jsx("td",{className:"td-admin-table",children:d(t.appointment_time).tz("Asia/Manila").format("hh:mm A")}),e.jsx("td",{className:"td-admin-table capitalize",children:t.warehouse_name}),e.jsx("td",{className:"td-admin-table capitalize",children:t.warehouse_address}),e.jsx("td",{className:"td-admin-table capitalize",children:t.activity}),e.jsx("td",{className:"td-admin-table capitalize",children:t.driver_name}),e.jsx("td",{className:"td-admin-table capitalize",children:t.helper_name}),e.jsx("td",{className:"td-admin-table",children:t.parking_slot}),e.jsx("td",{className:"td-admin-table",children:t.dock}),e.jsx("td",{className:"td-admin-table",children:t.time_in?d(t.time_in).format("MMMM D, YYYY hh:mm A"):"-"}),e.jsx("td",{className:"td-admin-table",children:t.time_out?d(t.time_out).format("MMMM D, YYYY hh:mm A"):"-"}),e.jsx("td",{className:"td-admin-table capitalize",children:e.jsx("span",{className:G(t.status),children:t.status})}),e.jsx("td",{className:"td-admin-table flex justify-center",children:e.jsx("button",{onClick:()=>pe(t.appointment_id),className:"cursor-pointer outline-none",title:`Download appointment id ${t.appointment_id}`,children:e.jsx(Z,{size:20,className:"mx-auto text-indigo-500"})})}),e.jsx("td",{className:"td-admin-table",title:`Download report for ${t.appointment_id}`,children:e.jsx(de,{document:e.jsx(ee,{data:i.filter(n=>n.appointment_id===t.appointment_id)}),fileName:`APPOINTMENT_ID:${t.appointment_id}_APPT_REPORT.pdf`,children:e.jsx(ce,{size:20,className:"mx-auto text-indigo-500 outline-none"})})}),e.jsxs("td",{className:"td-admin-table",children:[e.jsx("button",{title:`Edit appt. id ${t.appointment_id}`,className:"text-green-600 mr-2 cursor-pointer outline-none",onClick:()=>U(t.appointment_id),children:"Edit"}),e.jsx("button",{title:`Delete appt. id ${t.appointment_id}`,className:`text-red-600 outline-none ${t.status==="Completed"?"cursor-not-allowed opacity-50":"cursor-pointer"}`,onClick:()=>H(t.appointment_id),disabled:t.status==="Completed",children:"Delete"})]})]},t._id))})]})}),e.jsx(te,{currentPage:m,setCurrentPage:v,totalPages:R})]})})})})}):e.jsxs("p",{className:"text-gray-500 font-medium flex",children:["No scheduled appointments. Click",e.jsx(me,{onClick:F,className:"mx-2 text-blue-500 cursor-pointer"}),"to create a new appointment."]})]})}export{He as default};
