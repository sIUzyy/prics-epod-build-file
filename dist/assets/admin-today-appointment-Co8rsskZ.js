import{r as s,j as e,R as I,L,t as O}from"./index-Chad9CLA.js";import{d as P}from"./table-headers-NmVF5Ah3.js";import{D as Y,E as k,A as R,I as $,a as B}from"./appointment-report-B4EI5g7X.js";import{L as F}from"./loading-table-BAb0c7Cl.js";import{u as H,S as U}from"./search-bar-CgsKbdwB.js";import{a as V}from"./index-DW_MHI2K.js";import{d as i}from"./timezone-DS7qtbwd.js";import{c as G,b as W}from"./index-C06dF8FL.js";import{D as m}from"./Color-DmAsVZgK.js";import{g as q}from"./generateGatePass-QcUr6W2f.js";import{a as J}from"./menu-CM46qhEe.js";import"./createLucideIcon-C2ToIokP.js";import"./loading-spinner-BUHlXXSt.js";import"./triangle-alert-coWZifT7.js";import"./dialog-COJMBmk8.js";/* empty css                         */import"./checkAppointment-jH_aoGtD.js";import"./clsx-B-dksMZM.js";import"./pencil-BWuxfz4F.js";import"./chevron-down-Bns3dQA9.js";import"./tslib.es6-Cz-Yey_7.js";import"./JsBarcode-I2dIIH-k.js";import"./floating-ui.react-dom-DaaYR0vm.js";const K=I.memo(U);window.Buffer=W.Buffer;const Q="https://prics-epod-backend.onrender.com";function _e(){const[d,b]=s.useState([]),[u,x]=s.useState(!1),[f,h]=s.useState(!1),[y,_]=s.useState(null),[A,g]=s.useState(null),[l,M]=s.useState(""),[r,D]=s.useState(""),[S]=s.useState("today"),[w,j]=s.useState(!1);H(()=>D(l),500,[l]),s.useEffect(()=>{(async()=>{j(!0);try{const n=(await V.get(`${Q}/api/appointment`)).data.appointments;b(n)}catch(a){console.error("Failed to fetch appointment",a),O.error("We could not retrieve your appointment data. Please try again later.",{style:{backgroundColor:"#ff4d4d",color:"#fff"}})}finally{setTimeout(()=>{j(!1)},500)}})()},[]);const v=t=>{_(t),x(!0)},T=t=>{const a=d.find(n=>n.appointment_id===t);g(a),h(!0)},N=s.useMemo(()=>i().tz("Asia/Manila").startOf("day"),[]),p=s.useMemo(()=>d.filter(t=>i(t.appointment_date).tz("Asia/Manila").startOf("day").isSame(N,"day")).filter(t=>Object.values(t).some(a=>{const n=String(a).toLowerCase(),o=r.toLowerCase();return t.appointment_time&&i(t.appointment_time).tz("Asia/Manila").format("hh:mm A").toLowerCase().includes(o)?!0:!isNaN(r)&&!isNaN(a)?String(a).includes(r):n.includes(o)})).sort((t,a)=>{const n={pending:1,"in progress":2,delivered:3},o=n[t.status.toLowerCase()]||4,c=n[a.status.toLowerCase()]||4;if(o!==c)return o-c;const E=i(t.appointment_time).tz("Asia/Manila"),C=i(a.appointment_time).tz("Asia/Manila");return E.diff(C)}),[d,N,r]),z=t=>{const a=t.charAt(0).toUpperCase()+t.slice(1).toLowerCase();return a==="Pending"?`${m.transit} text-white px-5 py-1 rounded-full capitalize`:a==="In progress"?`${m.receiving} text-white px-5 py-1 rounded-full capitalize`:a==="Completed"?`${m.delivered} text-white px-5 py-1 rounded-full capitalize`:"bg-gray-400 text-white px-5 py-1 rounded-full capitalize"};return e.jsxs(e.Fragment,{children:[u&&e.jsx(Y,{open:u,setOpen:x,selectedAppointmentId:y}),f&&e.jsx(k,{open:f,setOpen:h,selectedAppointment:A}),e.jsx("div",{className:"table_section mt-5 font-inter w-full",children:e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"-m-1.5 overflow-x-auto",children:e.jsx("div",{className:"p-1.5 min-w-full inline-block align-middle",children:e.jsxs("div",{className:"border rounded-lg divide-y divide-gray-200",children:[e.jsx("div",{className:"py-5 px-4 flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-x-2",children:[e.jsx("div",{children:e.jsx(K,{searchTerm:l,setSearchTerm:M})}),e.jsx(R,{todayData:p,type:S})]})}),w?e.jsx(F,{}):p.length>0?e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"th-user-table",children:e.jsx("tr",{children:P.map((t,a)=>e.jsx("th",{className:"px-6 py-3",children:t},a))})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:p.map((t,a)=>e.jsxs("tr",{className:a%2===0?"bg-[#F3F4F6]":"",children:[e.jsx("td",{className:"td-admin-table",children:t.appointment_id}),e.jsx("td",{className:"td-admin-table",children:t.carrier_name}),e.jsx("td",{className:"td-admin-table uppercase",children:t.plate_no}),e.jsx("td",{className:"td-admin-table",children:i(t.appointment_date).tz("Asia/Manila").format("MMMM DD, YYYY")}),e.jsx("td",{className:"td-admin-table",children:i(t.appointment_time).tz("Asia/Manila").format("hh:mm A")}),e.jsx("td",{className:"td-admin-table capitalize",children:t.warehouse_name}),e.jsx("td",{className:"td-admin-table capitalize",children:t.warehouse_address}),e.jsx("td",{className:"td-admin-table capitalize",children:t.activity}),e.jsx("td",{className:"td-admin-table capitalize",children:t.driver_name}),e.jsx("td",{className:"td-admin-table capitalize",children:t.helper_name}),e.jsx("td",{className:"td-admin-table",children:t.parking_slot}),e.jsx("td",{className:"td-admin-table",children:t.dock}),e.jsx("td",{className:"td-admin-table",children:t.time_in?i(t.time_in).format("MMMM D, YYYY hh:mm A"):"-"}),e.jsx("td",{className:"td-admin-table",children:t.time_out?i(t.time_out).format("MMMM D, YYYY hh:mm A"):"-"}),e.jsx("td",{className:"td-admin-table capitalize",children:e.jsx("span",{className:z(t.status),children:t.status})}),e.jsx("td",{className:"td-admin-table flex justify-center",children:e.jsx("button",{onClick:()=>q(t.appointment_id),className:"cursor-pointer outline-none",title:`Download appointment id ${t.appointment_id}`,children:e.jsx($,{size:20,className:"mx-auto text-indigo-500"})})}),e.jsx("td",{className:"td-admin-table",children:e.jsx(G,{document:e.jsx(B,{data:d.filter(n=>n.appointment_id===t.appointment_id)}),fileName:`APPOINTMENT_ID:${t.appointment_id}_APPT_REPORT.pdf`,children:e.jsx(J,{size:20,className:"mx-auto text-indigo-500 outline-none"})})}),e.jsxs("td",{className:"td-admin-table",children:[e.jsx("button",{title:`Edit appt. id ${t.appointment_id}`,className:"text-green-600 mr-2 cursor-pointer outline-none",onClick:()=>T(t.appointment_id),children:"Edit"}),e.jsx("button",{title:`Delete appt. id ${t.appointment_id}`,className:`text-red-600 outline-none ${t.status==="Completed"?"cursor-not-allowed opacity-50":"cursor-pointer"}`,onClick:()=>v(t.appointment_id),disabled:t.status==="Completed",children:"Delete"})]})]},t._id))})]})}):e.jsxs("p",{className:"text-gray-500 font-medium px-4 py-5",children:["No scheduled appointments for today. View"," ",e.jsx(L,{to:"/admin/appointments/all-appointments",className:"text-blue-500 underline",children:"all appointments"})," ","for more information."]})]})})})})})]})}export{_e as default};
