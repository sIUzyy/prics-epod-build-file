import{r as l,j as e,t as P,P as t,R as z,L as ne}from"./index-Chad9CLA.js";import{C as M,a as F,b as U,c as $}from"./card-BwenR6nc.js";import{D as G,P as V,S as Y,V as N,I as K,p as J,T as r,a as H,b as ae,c as ie}from"./index-C06dF8FL.js";import{d as k,u as oe,t as le}from"./timezone-DS7qtbwd.js";import{D as W}from"./Color-DmAsVZgK.js";import{J as ce}from"./JsBarcode-I2dIIH-k.js";import{u as de,S as me}from"./search-bar-CgsKbdwB.js";import{a as L}from"./index-DW_MHI2K.js";import{L as ue}from"./loading-spinner-BUHlXXSt.js";import{y as pe,D as he,j as xe,Y as ge}from"./dialog-COJMBmk8.js";import{T as ye}from"./triangle-alert-coWZifT7.js";import{D as fe}from"./date-range-picker-filter-J1tn3TTb.js";import{r as je,I as Ne,F as be,g as ve,E as Q,a as De}from"./menu-CM46qhEe.js";import{O as we}from"./admin-order-summary-pagination-D35sU1a_.js";import{A as ke}from"./table-headers-NmVF5Ah3.js";import{A as Re}from"./arrow-down-to-line-BeSG99Eh.js";import{L as _e}from"./loading-table-BAb0c7Cl.js";import{L as Se}from"./loading-card-DoXf_Q8S.js";import{H as Te}from"./page-heading-rmoYobWP.js";import{C as Ce}from"./calendar-check-2-BF7h1SXI.js";import{c as Oe}from"./createLucideIcon-C2ToIokP.js";import{T as Pe}from"./truck-CgxKwvM_.js";import"./utils-9LinqH4U.js";import"./clsx-B-dksMZM.js";import"./tslib.es6-Cz-Yey_7.js";import"./floating-ui.react-dom-DaaYR0vm.js";/* empty css                         *//**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"16",height:"18",x:"4",y:"4",rx:"2",key:"1u9h20"}],["path",{d:"M8 10h6",key:"3oa6kw"}],["path",{d:"M8 14h8",key:"1fgep2"}],["path",{d:"M8 18h5",key:"17enja"}]],Le=Oe("NotepadText",Ee),Ae=c=>{const u=document.createElement("canvas");ce(u,c,{format:"CODE128",width:2,height:50,displayValue:!0});const s=document.createElement("a");s.href=u.toDataURL("image/png"),s.download=`epod_barcode_${c}.png`,s.click()},qe="https://prics-epod-backend.onrender.com";function Z({open:c,setOpen:u,selectedTrackingNo:s}){const[p,n]=l.useState(!1),d=async()=>{if(n(!0),!!s)try{(await L.delete(`${qe}/api/shipment/${s}`)).status===200&&(P.success(`Successfully deleted the tracking no. ${s}`,{style:{backgroundColor:"#28a745",color:"#fff"}}),u(!1))}catch(m){console.error("Failed to delete tracking no.:",m),P.error(`Failed to delete tracking no ${s}. Please try again later.`,{style:{backgroundColor:"#ff4d4d",color:"#fff"}})}finally{setTimeout(()=>{n(!1),window.location.reload()},1e3)}};return e.jsxs(pe,{open:c,onClose:u,className:"relative z-10",children:[e.jsx(he,{transition:!0,className:"fixed inset-0 bg-gray-500/75 transition-opacity data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in"}),e.jsx("div",{className:"fixed inset-0 z-10 w-screen overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:e.jsxs(xe,{transition:!0,className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all data-closed:translate-y-4 data-closed:opacity-0 data-enter:duration-300 data-enter:ease-out data-leave:duration-200 data-leave:ease-in sm:my-8 sm:w-full sm:max-w-lg data-closed:sm:translate-y-0 data-closed:sm:scale-95",children:[e.jsxs("div",{className:"bg-white   px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[e.jsxs(ge,{as:"h1",className:"font-inter flex items-center gap-x-2 font-medium text-base tracking-wider",children:[e.jsx(ye,{size:25,className:"text-red-500"})," Confirm deletion of Tracking No. ",s,"?"]}),e.jsx("div",{className:"mt-5 ",children:e.jsx("p",{children:"This action cannot be undone. Once deleted, you will not be able to recover it."})})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:[e.jsx("button",{type:"button",onClick:d,className:p?"inline-flex min-w-[120px] justify-center rounded-sm bg-red-600 px-10 py-2 text-center text-sm font-medium text-white shadow-xs  sm:ml-3 sm:w-auto cursor-progress opacity-50  ":"inline-flex w-full justify-center rounded-sm bg-red-600 px-10 py-2 text-center text-sm font-medium text-white shadow-xs hover:opacity-80 sm:ml-3 sm:w-auto cursor-pointer  ",disabled:p,children:p?e.jsxs("div",{className:"flex items-center gap-x-2",children:["Deleting",e.jsx(ue,{})]}):"Delete"}),e.jsx("button",{type:"button","data-autofocus":!0,onClick:()=>u(!1),disabled:p,className:p?"mt-3 inline-flex w-full justify-center rounded-sm bg-white px-10 py-2 text-sm font-medium text-gray-900   cursor-not-allowed   hover:bg-gray-50 sm:mt-0 sm:w-auto border-1":"mt-3 inline-flex w-full justify-center rounded-sm bg-white px-10 py-2 text-sm font-medium text-gray-900   cursor-pointer   hover:bg-gray-50 sm:mt-0 sm:w-auto border-1",children:"Cancel"})]})]})})})]})}Z.propTypes={open:t.bool.isRequired,setOpen:t.func.isRequired,selectedTrackingNo:t.string.isRequired};const a=Y.create({page:{padding:10},section:{marginBottom:20},logo:{width:150,height:85,objectFit:"cover",objectPosition:"center"},header:{fontSize:22,fontWeight:"bold",marginBottom:5,textAlign:"center"},date:{fontSize:12,fontWeight:"bold",textAlign:"center",color:"#333"},textDate:{fontSize:10,fontWeight:"normal",textAlign:"center"},tableHeader:{backgroundColor:"#ddd",fontWeight:"bold"},row:{flexDirection:"row",borderBottomWidth:1,borderBottomColor:"black",paddingVertical:4},column:{flex:1,fontSize:8,paddingHorizontal:2,textAlign:"center"},sectionTitle:{fontSize:14,fontWeight:"bold",textAlign:"left",marginBottom:10,color:"#333",textTransform:"uppercase"}});function I({data:c,preDeliveryData:u}){return e.jsx(G,{children:e.jsxs(V,{size:"LETTER",orientation:"landscape",style:a.page,children:[e.jsxs(N,{style:a.section,children:[e.jsx(K,{src:J,style:a.logo}),e.jsx(r,{style:a.header,children:"ELECTRONIC PROOF OF DELIVERY (e-POD) REPORT"}),e.jsxs(r,{style:a.date,children:[new Date().toLocaleDateString("en-US",{month:"long",day:"2-digit",year:"numeric"})," ","- ",new Date().toLocaleTimeString("en-US")]}),e.jsx(r,{style:a.textDate,children:"Date & Time Generated"})]}),e.jsx(r,{style:[a.sectionTitle,{marginTop:20}],children:"TRACKING NUMBER DETAILS"}),e.jsxs(N,{style:[a.row,a.tableHeader],children:[e.jsx(r,{style:a.column,children:"Tracking No"}),e.jsx(r,{style:a.column,children:"Shipped Date"}),e.jsx(r,{style:a.column,children:"Received Date"}),e.jsx(r,{style:a.column,children:"Waybill No"}),e.jsx(r,{style:a.column,children:"CV No"}),e.jsx(r,{style:a.column,children:"Plate No"}),e.jsx(r,{style:a.column,children:"Driver"}),e.jsx(r,{style:a.column,children:"Received By"}),e.jsx(r,{style:a.column,children:"Customer Name"}),e.jsx(r,{style:a.column,children:"Total CBM"}),e.jsx(r,{style:a.column,children:"Delivery Status"})]}),c.map((s,p)=>{const n=u.find(m=>m.pre_delivery_trackingNo===s.trackingNo);let d="In Transit";return n&&(n.pre_delivery_trackingNo.length>0&&(d="In Receiving"),n.pre_delivery_products.length===s.productCodes.length&&(d="Delivered")),e.jsxs(N,{style:a.row,children:[e.jsx(r,{style:a.column,children:s.trackingNo||"-"}),e.jsx(r,{style:a.column,children:s.shippedDate?new Date(s.shippedDate).toLocaleDateString("en-US"):"-"}),e.jsx(r,{style:a.column,children:n!=null&&n.pre_delivery_receivedDate?new Date(n.pre_delivery_receivedDate).toLocaleDateString("en-US"):"-"}),e.jsx(r,{style:a.column,children:s.waybillNo||"-"}),e.jsx(r,{style:a.column,children:s.cvNo||"-"}),e.jsx(r,{style:a.column,children:s.plateNo||"-"}),e.jsx(r,{style:a.column,children:s.driverName||"-"}),e.jsx(r,{style:a.column,children:(n==null?void 0:n.pre_delivery_receivedBy)||"-"}),e.jsx(r,{style:a.column,children:s.customerName||"-"}),e.jsxs(r,{style:a.column,children:[s.totalCbm||"-"," kg"]}),e.jsx(r,{style:a.column,children:d})]},p)}),e.jsx(r,{style:[a.sectionTitle,{marginTop:50}],children:"PRODUCT CODES DETAILS"}),e.jsxs(N,{style:[a.row,a.tableHeader],children:[e.jsx(r,{style:a.column,children:"Tracking No"}),e.jsx(r,{style:a.column,children:"Product Code"}),e.jsx(r,{style:a.column,children:"Shipped QTY"}),e.jsx(r,{style:a.column,children:"Actual Received QTY"}),e.jsx(r,{style:a.column,children:"Remarks"})]}),c.map((s,p)=>{const n=u.find(d=>d.pre_delivery_trackingNo===s.trackingNo);return e.jsx(N,{children:s.productCodes.map((d,m)=>{var f,b;return e.jsxs(N,{style:a.row,children:[m===0?e.jsx(r,{style:[a.column,a.trackingNo],children:s.trackingNo||"-"}):e.jsx(r,{style:[a.column,a.emptyColumn]}),e.jsx(r,{style:a.column,children:d.productCode||"-"}),e.jsx(r,{style:a.column,children:d.shippedQty||"-"}),e.jsx(r,{style:a.column,children:((f=n==null?void 0:n.pre_delivery_products[m])==null?void 0:f.receivedQty)||"-"}),e.jsx(r,{style:a.column,children:((b=n==null?void 0:n.pre_delivery_products[m])==null?void 0:b.remarks)||"-"})]},m)})},p)})]})})}I.propTypes={data:t.arrayOf(t.shape({trackingNo:t.string.isRequired,shippedDate:t.string.isRequired,waybillNo:t.string.isRequired,driverName:t.string.isRequired,customerName:t.string.isRequired,cvNo:t.string,plateNo:t.string,totalCbm:t.number,productCodes:t.arrayOf(t.shape({productCode:t.string.isRequired,shippedQty:t.number.isRequired,receivedQty:t.number,remarks:t.string})).isRequired})).isRequired,preDeliveryData:t.arrayOf(t.shape({pre_delivery_trackingNo:t.string.isRequired,pre_delivery_receivedDate:t.string,pre_delivery_receivedBy:t.string,pre_delivery_products:t.arrayOf(t.shape({productCode:t.string.isRequired,receivedQty:t.number,remarks:t.string}))})).isRequired};globalThis.Buffer=ae.Buffer;function X({data:c,preDeliveryData:u,startDate:s,endDate:p}){const n=l.useMemo(()=>c.filter(h=>{const j=new Date(h.shippedDate);if(s&&j<s)return!1;if(p){const v=new Date(p);if(v.setHours(23,59,59,999),j>v)return!1}return!0}),[c,s,p]),[d,m]=l.useMemo(()=>{if(n.length===0)return[null,null];const h=n.map(j=>new Date(j.shippedDate));return[new Date(Math.min(...h)),new Date(Math.max(...h))]},[n]),[f,b]=l.useState(null),[R,_]=l.useState(null);l.useEffect(()=>{(async()=>{try{const j=await H(e.jsx(I,{data:c,preDeliveryData:u})).toBlob();b(URL.createObjectURL(j));const v=await H(e.jsx(I,{data:n,preDeliveryData:u})).toBlob();_(URL.createObjectURL(v))}catch(j){console.error("Error generating PDF:",j)}})()},[c,u,n]);const S=h=>(h==null?void 0:h.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}))||"";return e.jsxs(je,{as:"div",className:"relative inline-block text-left",children:[e.jsx("div",{children:e.jsx(Ne,{title:"filter","aria-label":"Open filter menu",className:"outline-none cursor-pointer inline-flex w-full justify-center items-center gap-x-1.5 rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 hover:bg-gray-50",children:e.jsx(be,{size:18})})}),e.jsx(ve,{className:"absolute right-0 z-10 mt-2 w-60 origin-top-right rounded-md bg-white shadow-lg ring-1 ring-black/5 border-1",children:e.jsxs("div",{className:"py-1 flex flex-col",children:[e.jsx(Q,{as:"div",children:f?e.jsx("a",{href:f,download:"GENERAL_EPOD_REPORT.pdf",className:"px-3 py-2 text-sm text-gray-700 hover:text-indigo-500 cursor-pointer",children:"Download All E-POD Report"}):e.jsx("span",{className:"px-3 py-2 text-sm text-gray-500",children:"Generating PDF..."})}),e.jsx(Q,{as:"div",children:R?e.jsx("a",{href:R,download:`${S(d)}${m?`_${S(m)}`:""}_EPOD_REPORT.pdf`,className:"px-3 py-2 text-sm text-gray-700 hover:text-indigo-500 cursor-pointer",children:"Download Report (Date Range)"}):e.jsx("span",{className:"px-3 py-2 text-sm text-gray-500",children:"Generating PDF..."})})]})})]})}X.propTypes={data:t.array.isRequired,preDeliveryData:t.array.isRequired,startDate:t.instanceOf(Date),endDate:t.instanceOf(Date)};const i=Y.create({page:{padding:10},section:{marginBottom:20},logo:{width:150,height:85,objectFit:"cover",objectPosition:"center"},header:{fontSize:22,fontWeight:"bold",marginBottom:5,textAlign:"center"},date:{fontSize:12,fontWeight:"bold",textAlign:"center",color:"#333"},textDate:{fontSize:10,fontWeight:"normal",textAlign:"center"},tableHeader:{backgroundColor:"#ddd",fontWeight:"bold"},row:{flexDirection:"row",borderBottomWidth:1,borderBottomColor:"black",paddingVertical:4},column:{flex:1,fontSize:8,paddingHorizontal:2,textAlign:"center"},sectionTitle:{fontSize:14,fontWeight:"bold",textAlign:"left",marginBottom:10,color:"#333",textTransform:"uppercase"}});function ee({data:c,preDeliveryData:u}){return e.jsx(G,{children:e.jsxs(V,{size:"LETTER",orientation:"landscape",style:i.page,children:[e.jsxs(N,{style:i.section,children:[e.jsx(K,{src:J,style:i.logo}),e.jsx(r,{style:i.header,children:"ELECTRONIC PROOF OF DELIVERY (e-POD) REPORT"}),e.jsxs(r,{style:i.date,children:[new Date().toLocaleDateString("en-US",{month:"long",day:"2-digit",year:"numeric"})," ","- ",new Date().toLocaleTimeString("en-US")]}),e.jsx(r,{style:i.textDate,children:"Date & Time Generated"})]}),e.jsx(r,{style:[i.sectionTitle,{marginTop:20}],children:"TRACKING NUMBER DETAILS"}),e.jsxs(N,{style:[i.row,i.tableHeader],children:[e.jsx(r,{style:i.column,children:"Tracking No"}),e.jsx(r,{style:i.column,children:"Shipped Date"}),e.jsx(r,{style:i.column,children:"Received Date"}),e.jsx(r,{style:i.column,children:"Waybill No"}),e.jsx(r,{style:i.column,children:"CV No"}),e.jsx(r,{style:i.column,children:"Plate No"}),e.jsx(r,{style:i.column,children:"Driver"}),e.jsx(r,{style:i.column,children:"Received By"}),e.jsx(r,{style:i.column,children:"Customer Name"}),e.jsx(r,{style:i.column,children:"Total CBM"}),e.jsx(r,{style:i.column,children:"Delivery Status"})]}),c.map((s,p)=>{const n=u.find(m=>m.pre_delivery_trackingNo===s.trackingNo);let d="In Transit";return n&&(n.pre_delivery_trackingNo.length>0&&(d="In Receiving"),n.pre_delivery_products.length===s.productCodes.length&&(d="Delivered")),e.jsxs(N,{style:i.row,children:[e.jsx(r,{style:i.column,children:s.trackingNo||"-"}),e.jsx(r,{style:i.column,children:s.shippedDate?new Date(s.shippedDate).toLocaleDateString("en-US"):"-"}),e.jsx(r,{style:i.column,children:n!=null&&n.pre_delivery_receivedDate?new Date(n.pre_delivery_receivedDate).toLocaleDateString("en-US"):"-"}),e.jsx(r,{style:i.column,children:s.waybillNo||"-"}),e.jsx(r,{style:i.column,children:s.cvNo||"-"}),e.jsx(r,{style:i.column,children:s.plateNo||"-"}),e.jsx(r,{style:i.column,children:s.driverName||"-"}),e.jsx(r,{style:i.column,children:(n==null?void 0:n.pre_delivery_receivedBy)||"-"}),e.jsx(r,{style:i.column,children:s.customerName||"-"}),e.jsxs(r,{style:i.column,children:[s.totalCbm||"-"," kg"]}),e.jsx(r,{style:i.column,children:d})]},p)}),e.jsx(r,{style:[i.sectionTitle,{marginTop:50}],children:"PRODUCT CODES DETAILS"}),e.jsxs(N,{style:[i.row,i.tableHeader],children:[e.jsx(r,{style:i.column,children:"Tracking No"}),e.jsx(r,{style:i.column,children:"Product Code"}),e.jsx(r,{style:i.column,children:"Shipped QTY"}),e.jsx(r,{style:i.column,children:"Actual Received QTY"}),e.jsx(r,{style:i.column,children:"Remarks"})]}),c.map((s,p)=>{const n=u.find(d=>d.pre_delivery_trackingNo===s.trackingNo);return e.jsx(N,{children:s.productCodes.map((d,m)=>{var f,b;return e.jsxs(N,{style:i.row,children:[m===0?e.jsx(r,{style:[i.column,i.trackingNo],children:s.trackingNo||"-"}):e.jsx(r,{style:[i.column,i.emptyColumn]}),e.jsx(r,{style:i.column,children:d.productCode||"-"}),e.jsx(r,{style:i.column,children:d.shippedQty||"-"}),e.jsx(r,{style:i.column,children:((f=n==null?void 0:n.pre_delivery_products[m])==null?void 0:f.receivedQty)||"-"}),e.jsx(r,{style:i.column,children:((b=n==null?void 0:n.pre_delivery_products[m])==null?void 0:b.remarks)||"-"})]},m)})},p)})]})})}ee.propTypes={data:t.arrayOf(t.shape({trackingNo:t.string.isRequired,shippedDate:t.string.isRequired,waybillNo:t.string.isRequired,driverName:t.string.isRequired,customerName:t.string.isRequired,cvNo:t.string,plateNo:t.string,totalCbm:t.number,productCodes:t.arrayOf(t.shape({productCode:t.string.isRequired,shippedQty:t.number.isRequired,receivedQty:t.number,remarks:t.string})).isRequired})).isRequired,preDeliveryData:t.arrayOf(t.shape({pre_delivery_trackingNo:t.string.isRequired,pre_delivery_receivedDate:t.string,pre_delivery_receivedBy:t.string,pre_delivery_products:t.arrayOf(t.shape({productCode:t.string.isRequired,receivedQty:t.number,remarks:t.string}))})).isRequired};const Be=z.memo(Z),ze=z.memo(me),Me=z.memo(X),Fe=z.memo(fe);function te({data:c,preDeliveryData:u}){const[s,p]=l.useState(null),[n,d]=l.useState(null),[m,f]=l.useState(!1),[b,R]=l.useState(null),[_,S]=l.useState(""),[h,j]=l.useState(""),[v,A]=l.useState(1);de(()=>j(_),500,[_]);const C=l.useMemo(()=>c.filter(o=>{const g=k(o.shippedDate);if(s&&g.isBefore(k(s)))return!1;if(n){const y=k(n).endOf("day");if(g.isAfter(y))return!1}const D=u.find(y=>y.pre_delivery_trackingNo===o.trackingNo);if(h){const y=h.toLowerCase().replace(/\s+/g,""),re=Object.values(o).some(T=>typeof T=="string"?T.toLowerCase().replace(/\s+/g,"").includes(y):typeof T=="number"?T.toString().includes(h):!1),se=D?Object.values(D).some(T=>typeof T=="string"?T.toLowerCase().replace(/\s+/g,"").includes(y):!1):!1;return re||se}return!0}).sort((o,g)=>k(g.createdAt).isBefore(k(o.createdAt))?-1:1),[c,u,h,s,n]),O=10,q=l.useMemo(()=>Math.ceil(C.length/O),[C]),w=l.useMemo(()=>{const o=(v-1)*O;return C.slice(o,o+O)},[C,v]),x=o=>{R(o),f(!0)},E=o=>o==="In Transit"?`${W.transit} text-white px-5 py-1 rounded-full capitalize`:o==="In Receiving"?`${W.receiving} text-white px-5 py-1 rounded-full capitalize`:o==="Delivered"?`${W.delivered} text-white px-5 py-1 rounded-full capitalize`:"bg-gray-400 text-white px-5 py-1 rounded-full capitalize";return e.jsxs(e.Fragment,{children:[m&&e.jsx(Be,{selectedTrackingNo:b,open:m,setOpen:f}),e.jsx("div",{className:"table_section mt-5 font-inter w-full  ",children:e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"-m-1.5 overflow-x-auto",children:[e.jsx("div",{className:"p-1.5 min-w-full inline-block align-middle",children:e.jsxs("div",{className:"border rounded-lg divide-y divide-gray-200",children:[e.jsxs("div",{className:"py-5 px-4 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-x-2",children:[e.jsx(ze,{searchTerm:_,setSearchTerm:S}),e.jsx(Me,{data:c,preDeliveryData:u,startDate:s,endDate:n})]}),e.jsx("div",{children:e.jsx(Fe,{startDate:s,endDate:n,setStartDate:p,setEndDate:d})})]}),e.jsx("div",{className:"overflow-hidden ",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"th-user-table",children:e.jsx("tr",{children:ke.map((o,g)=>e.jsx("th",{className:"px-5 py-3 tracking-wider",children:o},g))})}),e.jsx("tbody",{className:"divide-y divide-gray-200 ",children:w.map((o,g)=>{const D=u.find(y=>y.pre_delivery_trackingNo===o.trackingNo);return e.jsxs("tr",{className:g%2===0?"bg-[#F3F4F6]":"",children:[e.jsx("td",{className:"td-admin-table",children:e.jsx(ne,{to:`/admin/ordersummary/${o.trackingNo}`,children:e.jsxs("div",{className:"bg-[#343A40] px-4 text-white py-1 rounded-full flex items-center",children:[e.jsx("span",{children:o.trackingNo}),e.jsxs("span",{className:"ml-2 text-[#FFD166]",children:["[",o.productCodes.length,"]"]})]})})}),e.jsx("td",{className:"td-admin-table",children:new Date(o.shippedDate).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"})}),e.jsx("td",{className:"td-admin-table",children:D?new Date(D.pre_delivery_receivedDate).toLocaleString("en-US",{timeZone:"Asia/Manila",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}):"-"}),e.jsx("td",{className:"td-admin-table",children:o.waybillNo}),e.jsx("td",{className:"td-admin-table",children:o.cvNo}),e.jsx("td",{className:"td-admin-table",children:o.plateNo}),e.jsx("td",{className:"td-admin-table",children:o.driverName}),e.jsx("td",{className:"td-admin-table",children:D?D.pre_delivery_receivedBy:"-"}),e.jsx("td",{className:"td-admin-table",children:o.customerName}),e.jsxs("td",{className:"td-admin-table",children:[o.totalCbm," kg"]}),e.jsx("td",{className:"td-admin-table capitalize",children:e.jsx("span",{className:E(o.epodStatus),children:o.epodStatus})}),e.jsx("td",{className:"td-admin-table w-full  flex justify-center  ",children:e.jsx("button",{onClick:()=>Ae(o.trackingNo),className:"cursor-pointer outline-none ",title:`Download tracking no. ${o.trackingNo}`,children:e.jsx(Re,{size:20,className:"mx-auto text-indigo-500"})})}),e.jsx("td",{className:"td-admin-table  ",title:`Download report for ${o.trackingNo}`,children:e.jsx(ie,{document:e.jsx(ee,{data:c.filter(y=>y.trackingNo===o.trackingNo),preDeliveryData:u.filter(y=>y.pre_delivery_trackingNo===o.trackingNo)}),fileName:`TRACKING_NO:${o.trackingNo}_EPOD_REPORT.pdf`,children:e.jsx(De,{size:20,className:"mx-auto text-indigo-500 outline-none "})})}),e.jsx("td",{className:"td-admin-table",children:e.jsx("button",{onClick:()=>x(o.trackingNo),className:"text-[#EB191D] cursor-pointer outline-none ",title:`Delete ${o.trackingNo}`,children:"Delete"})})]},o._id)})})]})}),e.jsx(we,{currentPage:v,setCurrentPage:A,totalPages:q})]})}),w&&w.length===0&&e.jsx("p",{className:"ml-2 mt-2 text-gray-500  font-medium",children:"No records found."})]})})})]})}te.propTypes={data:t.arrayOf(t.shape({_id:t.string.isRequired,trackingNo:t.string.isRequired,productCodes:t.arrayOf(t.string).isRequired,shippedDate:t.string.isRequired,waybillNo:t.string.isRequired,cvNo:t.string.isRequired,plateNo:t.string.isRequired,driverName:t.string.isRequired,customerName:t.string.isRequired,totalCbm:t.number.isRequired,delivery_status:t.string})).isRequired,preDeliveryData:t.arrayOf(t.shape({pre_delivery_trackingNo:t.string.isRequired,pre_delivery_receivedDate:t.string.isRequired,pre_delivery_receivedBy:t.string.isRequired})).isRequired};k.extend(oe);k.extend(le);const B="https://prics-epod-backend.onrender.com";function ht(){const[c,u]=l.useState([]),[s,p]=l.useState([]),[n,d]=l.useState([]),[m,f]=l.useState([]),[b,R]=l.useState(!1),[_,S]=l.useState(!1),[h,j]=l.useState(!1),[v,A]=l.useState(!1),C=b||_||h||v;l.useEffect(()=>{(async()=>{R(!0);try{const o=(await L.get(`${B}/api/shipment`)).data.shipments.map(g=>{let D=0;return g.productCodes.forEach(y=>{D+=y.total_cbm_per_item}),{...g,totalCbm:D}});u(o)}catch(x){console.error("Failed to fetch shipments:",x),P.error("We could not load your dashboard data. Please try again later.",{style:{backgroundColor:"#ff4d4d",color:"#fff"}})}finally{R(!1)}})()},[]),l.useEffect(()=>{if(c.length===0)return;(async()=>{S(!0);try{const x=c.map(g=>L.get(`${B}/api/pre-delivery/${g.trackingNo}`)),o=(await Promise.all(x)).map(g=>g.data);p(o)}catch(x){console.error("Failed to fetch pre-delivery data:",x),P.error("We could not load your dashboard data. Please try again later.",{style:{backgroundColor:"#ff4d4d",color:"#fff"}})}finally{S(!1)}})()},[c]),l.useEffect(()=>{(async()=>{j(!0);try{const x=await L.get(`${B}/api/truck`);d(x.data.truck)}catch(x){console.error(x),P.error("We could not load your truck data. Please try again later.",{style:{backgroundColor:"#ff4d4d",color:"#fff"}})}finally{j(!1)}})()},[]),l.useEffect(()=>{(async()=>{A(!0);try{const E=(await L.get(`${B}/api/appointment`)).data.appointments;f(E)}catch(x){console.error("Failed to fetch appointment",x),P.error("We could not retrieve your appointment data. Please try again later.",{style:{backgroundColor:"#ff4d4d",color:"#fff"}})}finally{A(!1)}})()},[]);const O=l.useMemo(()=>k().tz("Asia/Manila").startOf("day"),[]),q=l.useMemo(()=>m.filter(w=>k(w.appointment_date).tz("Asia/Manila").startOf("day").isSame(O,"day")).length,[m,O]);return e.jsxs("div",{className:"my-5 mx-4",children:[e.jsx(Te,{title:"dashboard",description:` Below is an overview of all orders, including transit, shipped, and
          completed transaction`}),C?e.jsxs("div",{children:[e.jsx(Se,{}),e.jsx(_e,{})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card_section flex gap-x-3",children:[e.jsxs(M,{className:"max-w-[320px]",children:[e.jsx(F,{children:e.jsxs("div",{className:"flex justify-between items-center ",children:[e.jsx(U,{className:"font-inter text-base font-medium",children:"Today’s Appointment"}),e.jsx(Ce,{size:25})]})}),e.jsxs($,{children:[e.jsxs("h1",{className:"text-5xl font-bebas tracking-wider",children:[" ",q||0]}),e.jsx("p",{className:"text-sm text-[#6c757d] mt-5",children:"Go to the Appointment menu to create and view the list of appointments."})]})]}),e.jsxs(M,{className:"max-w-[320px]",children:[e.jsx(F,{children:e.jsxs("div",{className:"flex justify-between items-center ",children:[e.jsx(U,{className:"font-inter text-base font-medium",children:"Total Tracking No."}),e.jsx(Le,{size:25})]})}),e.jsxs($,{children:[e.jsx("h1",{className:"text-5xl font-bebas tracking-wider",children:c.length>0?c.length:0}),e.jsx("p",{className:"text-sm text-[#6c757d] mt-5",children:"Use this tracking number to monitor the movement and status of items within the warehouse."})]})]}),e.jsxs(M,{className:"max-w-[320px]",children:[e.jsx(F,{children:e.jsxs("div",{className:"flex justify-between items-center ",children:[e.jsx(U,{className:"font-inter text-base font-medium",children:"Total Trucks"}),e.jsx(Pe,{size:25})]})}),e.jsxs($,{children:[e.jsx("h1",{className:"text-5xl font-bebas tracking-wider",children:n.length>0?n.length:0}),e.jsx("p",{className:"text-sm text-[#6c757d] mt-5",children:"Total number of trucks you own and have available for your operations or transport needs."})]})]})]}),e.jsx(te,{data:c,preDeliveryData:s})]})]})}export{ht as default};
