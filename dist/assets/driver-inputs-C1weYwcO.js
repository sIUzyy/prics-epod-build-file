import{a as L,u as I,c as C,r as t,j as e,t as $}from"./index-Chad9CLA.js";import{b as F}from"./index-DHZCN8Wt.js";import{a as y}from"./index-DW_MHI2K.js";import{E as k}from"./ErrorMessage-BS5JYQ2c.js";import{L as A}from"./loading-spinner-BUHlXXSt.js";import"./iconBase-B7Hzua4b.js";const N="https://prics-epod-backend.onrender.com";function T(){const{signIn:v}=L(),{selectedWarehouse:d,setSelectedWarehouse:w}=I(),j=C(),[s,E]=t.useState(""),[n,D]=t.useState(""),[p,o]=t.useState(!1),[g,b]=t.useState(""),[l,f]=t.useState(""),[i,m]=t.useState(""),[u,h]=t.useState(""),[S,W]=t.useState([]),P=async r=>{var a,c;if(r.preventDefault(),o(!0),b(""),!s&&!n&&!d){f("Name field cannot be empty"),m("Plate Number field cannot be empty"),h("Warehouse selection is required."),o(!1);return}if(!s){f("Name field cannot be empty"),o(!1);return}if(!n){m("Plate Number field cannot be empty"),o(!1);return}if(!d){h("Warehouse selection is required."),o(!1);return}try{(await y.post(`${N}/api/user/signin`,{name:s,plate_number:n})).status===200&&(v({name:s,plateNo:n,role:"driver"}),console.log("Driver login successfully..."),j("/plate-no"))}catch(x){b(((c=(a=x.response)==null?void 0:a.data)==null?void 0:c.message)||"Login failed. Please try again later.")}finally{o(!1)}};return t.useEffect(()=>{(async()=>{o(!0);try{const c=(await y.get(`${N}/api/warehouse`)).data.warehouse;W(c)}catch(a){console.error("Failed to fetch warehouse:",a),$.error("We could not load your warehouse list data. Please try again later.",{style:{backgroundColor:"#ff4d4d",color:"#fff"}})}finally{o(!1)}})()},[]),e.jsxs("div",{className:"w-full my-5 text-[#979090]",children:[e.jsx("input",{type:"text",placeholder:l||"Name",className:`border-1 p-3 w-full rounded-lg border-[#979090] focus:outline-none focus:ring-2 focus:ring-blue-500 2xl:p-4 
          ${l?"placeholder-red-500 border-red-500":""}`,value:s,onChange:r=>{E(r.target.value),l&&f("")}}),e.jsx("input",{type:"text",placeholder:i||"Plate Number",className:`border-1 p-3 w-full mt-4 rounded-lg border-[#979090] focus:outline-none focus:ring-2 focus:ring-blue-500 2xl:p-4 
          ${i?"placeholder-red-500 border-red-500":""}`,value:n,onChange:r=>{D(r.target.value),i&&m("")}}),e.jsxs("div",{className:"relative mt-4",children:[e.jsxs("select",{className:`border-1 p-3 w-full rounded-lg 
            ${u?"border-red-500 focus:ring-red-500":"border-[#979090] focus:ring-blue-500"} 
            outline-0 appearance-none pr-10`,value:d||"",onChange:r=>{w(r.target.value),u&&h("")},children:[e.jsx("option",{value:"",children:u||"Select Warehouse"}),S.map((r,a)=>e.jsx("option",{value:r.address,children:r.warehouseName},a))]}),e.jsx("div",{className:"absolute inset-y-0 right-3 flex items-center pointer-events-none",children:e.jsx(F,{size:20})})]}),e.jsx("button",{onClick:P,className:p?"w-full mt-10 p-3 rounded-md bg-[#1877F2] text-white font-inter font-bold hover:opacity-75 transition-opacity duration-300 2xl:p-4 opacity-50 cursor-not-allowed":"w-full mt-10 p-3 rounded-md bg-[#1877F2] text-white font-inter font-bold hover:opacity-75 transition-opacity duration-300 2xl:p-4  cursor-pointer",disabled:p,children:p?e.jsx(A,{}):"Log In"}),g&&e.jsx(k,{message:g})]})}export{T as default};
